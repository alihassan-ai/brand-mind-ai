{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/NEW/packages/shared/src/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ||\n  new PrismaClient({\n    log: ['query', 'error', 'warn'],\n  });\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,sMAAY,CAAC;IACf,KAAK;QAAC;QAAS;QAAS;KAAO;AACjC;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/NEW/packages/shared/src/types/index.ts"],"sourcesContent":["// Common types used across packages\n\nexport interface ShopContext {\n  shopId: string;\n  shopDomain: string;\n  accessToken: string;\n}\n\nexport interface DateRange {\n  from: Date;\n  to: Date;\n}\n\nexport interface PaginationOptions {\n  limit?: number;\n  cursor?: string;\n}\n\nexport interface ApiResponse<T> {\n  success: boolean;\n  data?: T;\n  error?: string;\n}\n\nexport interface ScoringWeights {\n  storeFit: number;\n  gapFill: number;\n  trendScore: number;\n  marginPotential: number;\n  competitionLevel: number;\n  seasonalAlignment: number;\n}\n\nexport const DEFAULT_SCORING_WEIGHTS: ScoringWeights = {\n  storeFit: 0.25,\n  gapFill: 0.20,\n  trendScore: 0.15,\n  marginPotential: 0.15,\n  competitionLevel: 0.10,\n  seasonalAlignment: 0.15,\n};\n"],"names":[],"mappings":"AAAA,oCAAoC;;;;;AAiC7B,MAAM,0BAA0C;IACrD,UAAU;IACV,SAAS;IACT,YAAY;IACZ,iBAAiB;IACjB,kBAAkB;IAClB,mBAAmB;AACrB"}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/NEW/packages/shared/src/index.ts"],"sourcesContent":["// Shared exports for BrandMind AI\nexport { prisma } from './prisma';\nexport * from './types';\n"],"names":[],"mappings":";AAAA,kCAAkC;AAClC;AACA"}},
    {"offset": {"line": 110, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/NEW/packages/backend/src/shopify/client.ts"],"sourcesContent":["import { shopifyApi, ApiVersion, LogSeverity, Shopify } from '@shopify/shopify-api';\nimport '@shopify/shopify-api/adapters/web-api';\nimport { prisma } from '@brandmind/shared';\nimport { PrismaSessionStorage } from '@shopify/shopify-app-session-storage-prisma';\n\nlet shopifyInstance: Shopify | null = null;\n\nexport function getShopify(): Shopify {\n    if (shopifyInstance) return shopifyInstance;\n\n    const apiKey = (process.env.SHOPIFY_API_KEY || '').trim();\n    const apiSecretKey = (process.env.SHOPIFY_API_SECRET || '').trim();\n    const appUrl = (process.env.SHOPIFY_APP_URL || '').trim();\n\n    if (!apiKey || apiKey === 'MISSING') {\n        console.error('[Shopify Client] CRITICAL: SHOPIFY_API_KEY is missing or invalid.');\n    }\n\n    shopifyInstance = shopifyApi({\n        apiKey: apiKey || 'MISSING',\n        apiSecretKey: apiSecretKey || 'MISSING',\n        scopes: process.env.SCOPES?.split(',') || ['read_products', 'read_orders', 'read_customers'],\n        hostName: appUrl.replace(/https?:\\/\\//, '') || 'localhost',\n        apiVersion: ApiVersion.October24,\n        isEmbeddedApp: false,\n        logger: {\n            level: LogSeverity.Info,\n        },\n    });\n\n    return shopifyInstance;\n}\n\n// Export a proxy as default for backward compatibility\nconst shopify = new Proxy({} as Shopify, {\n    get(_, prop) {\n        return (getShopify() as any)[prop];\n    }\n});\n\nexport const sessionStorage = new PrismaSessionStorage(prisma);\n\nexport default shopify;\n"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;AACA;AACA;AAAA;AACA;;;;;AAEA,IAAI,kBAAkC;AAE/B,SAAS;IACZ,IAAI,iBAAiB,OAAO;IAE5B,MAAM,SAAS,CAAC,QAAQ,GAAG,CAAC,eAAe,IAAI,EAAE,EAAE,IAAI;IACvD,MAAM,eAAe,CAAC,QAAQ,GAAG,CAAC,kBAAkB,IAAI,EAAE,EAAE,IAAI;IAChE,MAAM,SAAS,CAAC,QAAQ,GAAG,CAAC,eAAe,IAAI,EAAE,EAAE,IAAI;IAEvD,IAAI,CAAC,UAAU,WAAW,WAAW;QACjC,QAAQ,KAAK,CAAC;IAClB;IAEA,kBAAkB,IAAA,2MAAU,EAAC;QACzB,QAAQ,UAAU;QAClB,cAAc,gBAAgB;QAC9B,QAAQ,QAAQ,GAAG,CAAC,MAAM,EAAE,MAAM,QAAQ;YAAC;YAAiB;YAAe;SAAiB;QAC5F,UAAU,OAAO,OAAO,CAAC,eAAe,OAAO;QAC/C,YAAY,2LAAU,CAAC,SAAS;QAChC,eAAe;QACf,QAAQ;YACJ,OAAO,4LAAW,CAAC,IAAI;QAC3B;IACJ;IAEA,OAAO;AACX;AAEA,uDAAuD;AACvD,MAAM,UAAU,IAAI,MAAM,CAAC,GAAc;IACrC,KAAI,CAAC,EAAE,IAAI;QACP,OAAO,AAAC,YAAoB,CAAC,KAAK;IACtC;AACJ;AAEO,MAAM,iBAAiB,IAAI,+NAAoB,CAAC,+IAAM;uCAE9C"}},
    {"offset": {"line": 166, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/NEW/packages/backend/src/shopify/index.ts"],"sourcesContent":["export * from './client';\nexport { default } from './client';\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":["file:///Users/mac/Desktop/NEW/packages/frontend/src/app/api/auth/shopify/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport shopify from '@brandmind/backend/shopify';\n\nexport async function GET(req: NextRequest) {\n    const { searchParams } = new URL(req.url);\n    const shop = searchParams.get('shop');\n\n    if (!shop) {\n        return NextResponse.json({ error: 'Missing shop parameter' }, { status: 400 });\n    }\n\n    console.log('[Shopify OAuth Debug] process.env.SHOPIFY_API_KEY:', process.env.SHOPIFY_API_KEY ? 'FOUND' : 'MISSING');\n    console.log('[Shopify OAuth Debug] process.env.SHOPIFY_APP_URL:', process.env.SHOPIFY_APP_URL);\n\n    // Normalize shop domain\n    let cleanShop = shop.toLowerCase().trim();\n    if (!cleanShop.includes('.myshopify.com')) {\n        cleanShop = `${cleanShop}.myshopify.com`;\n    }\n\n    try {\n        // Begin OAuth flow\n        // Note: shopify.auth.begin returns a response that sets a cookie and redirects\n        return await shopify.auth.begin({\n            shop: cleanShop,\n            callbackPath: '/api/auth/shopify/callback',\n            isOnline: false,\n            rawRequest: req,\n            rawResponse: new Response(), // This is a dummy as we'll construct our own redirect\n        });\n    } catch (error: any) {\n        console.error('[Shopify OAuth] Failed to begin:', error);\n        return NextResponse.json({ error: 'Failed to initiate Shopify auth' }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAEO,eAAe,IAAI,GAAgB;IACtC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;IACxC,MAAM,OAAO,aAAa,GAAG,CAAC;IAE9B,IAAI,CAAC,MAAM;QACP,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAyB,GAAG;YAAE,QAAQ;QAAI;IAChF;IAEA,QAAQ,GAAG,CAAC,sDAAsD,QAAQ,GAAG,CAAC,eAAe,GAAG,UAAU;IAC1G,QAAQ,GAAG,CAAC,sDAAsD,QAAQ,GAAG,CAAC,eAAe;IAE7F,wBAAwB;IACxB,IAAI,YAAY,KAAK,WAAW,GAAG,IAAI;IACvC,IAAI,CAAC,UAAU,QAAQ,CAAC,mBAAmB;QACvC,YAAY,GAAG,UAAU,cAAc,CAAC;IAC5C;IAEA,IAAI;QACA,mBAAmB;QACnB,+EAA+E;QAC/E,OAAO,MAAM,4JAAO,CAAC,IAAI,CAAC,KAAK,CAAC;YAC5B,MAAM;YACN,cAAc;YACd,UAAU;YACV,YAAY;YACZ,aAAa,IAAI;QACrB;IACJ,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,oCAAoC;QAClD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAkC,GAAG;YAAE,QAAQ;QAAI;IACzF;AACJ"}}]
}